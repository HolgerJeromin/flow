<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
<head>
    <meta charset='utf-8'>
    <title>Flow | Checking third-party code</title>
    <link rel='stylesheet' href='/static/flow.css' type='text/css'/>
    <link rel='stylesheet' href='/static/syntax.css' type='text/css'/>
    <link rel="stylesheet" href='/static/pygments.css' type='text/css'/>
    <link rel='shortcut icon' href='/static/favicon.png'>
    <meta name='viewport' content='width=480'>
    <meta property="og:title" content="Checking third-party code" />
    <meta property="og:site_name" content="flowtype">
    <meta property='og:description' content='Flow is a static type checker for
    JavaScript.'>
    <meta property='og:image' content='http://flowtype.org/static/flow-og-image.png'>
    <meta property='og:url' content="http://flowtype.org/docs/third-party.html">
    
    <meta property='og:type' content='website'>
    
    <script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script>
    <script type="text/javascript">{'try{Typekit.load();}catch(e){}'}</script>
    <link rel="alternate" type="application/rss+xml" title="Flow" href="http://flowtype.org/blog/feed.xml">
</head>
<body>

<header class='topbar'><nav class='width'>
<a href='/'>
  <img src="/static/flow-logo.png" class="logo">
</a>
    <ul>
      <li><a href="/docs/getting-started.html#_"
           class="active" >
          Docs
      </a></li>
      <li><a href="/docs/about-flow.html#_"
          >
          About
      </a></li>
      <li><a href="/support.html"
          >
          Support
      </a></li>
      <li><a href="/blog"
          >
          Blog
      </a></li>
      <li><a href="http://github.com/facebook/flow">GitHub</a>
    </ul>
</nav></header>


<section class='content'><div class='width'>

<nav class='toc'>
  
    <section>
      <h3>Quick Start</h3>
      <ul>
        
          <li>
            <a href="/docs/about-flow.html#_">
              About Flow
            </a>
            
          </li>
        
          <li>
            <a href="/docs/getting-started.html#_">
              Getting started with Flow
            </a>
            
          </li>
        
          <li>
            <a href="/docs/five-simple-examples.html#_">
              Five simple examples
            </a>
            
          </li>
        
      </ul>
    </section>
  
    <section>
      <h3>User Guide</h3>
      <ul>
        
          <li>
            <a href="/docs/new-project.html#_">
              Starting a new Flow project
            </a>
            
          </li>
        
          <li>
            <a href="/docs/existing.html#_">
              Running Flow on existing code
            </a>
            
          </li>
        
          <li>
            <a href="/docs/type-annotations.html#_">
              Adding Type Annotations
            </a>
            
          </li>
        
          <li>
            <a href="/docs/third-party.html#_" class="active">
              Checking third-party code
            </a>
            
          </li>
        
          <li>
            <a href="/docs/running.html#_">
              Running Flow code
            </a>
            
          </li>
        
          <li>
            <a href="/docs/troubleshooting.html#_">
              Troubleshooting
            </a>
            
          </li>
        
          <li>
            <a href="/docs/cli.html#_">
              Using the CLI
            </a>
            
          </li>
        
          <li>
            <a href="/docs/advanced-configuration.html#_">
              Advanced Configuration
            </a>
            
          </li>
        
      </ul>
    </section>
  
    <section>
      <h3>Language Reference</h3>
      <ul>
        
          <li>
            <a href="/docs/quick-reference.html#_">
              Quick Reference
            </a>
            
          </li>
        
          <li>
            <a href="/docs/builtins.html#_">
              Built-in Types
            </a>
            
          </li>
        
          <li>
            <a href="/docs/syntax.html#_">
              Syntax
            </a>
            
          </li>
        
          <li>
            <a href="/docs/arrays.html#_">
              Arrays and Tuples
            </a>
            
          </li>
        
          <li>
            <a href="/docs/classes.html#_">
              Classes
            </a>
            
          </li>
        
          <li>
            <a href="/docs/objects.html#_">
              Objects
            </a>
            
          </li>
        
          <li>
            <a href="/docs/functions.html#_">
              Functions
            </a>
            
          </li>
        
          <li>
            <a href="/docs/nullable-types.html#_">
              Maybe Types
            </a>
            
          </li>
        
          <li>
            <a href="/docs/destructuring.html#_">
              Destructuring
            </a>
            
          </li>
        
          <li>
            <a href="/docs/union-intersection-types.html#_">
              Union and Intersection Types
            </a>
            
          </li>
        
          <li>
            <a href="/docs/type-aliases.html#_">
              Type Aliases
            </a>
            
          </li>
        
          <li>
            <a href="/docs/typeof.html#_">
              Typeof types
            </a>
            
          </li>
        
          <li>
            <a href="/docs/dynamic-type-tests.html#_">
              Dynamic Type Tests
            </a>
            
          </li>
        
          <li>
            <a href="/docs/modules.html#_">
              Modules
            </a>
            
          </li>
        
          <li>
            <a href="/docs/declarations.html#_">
              Declarations
            </a>
            
          </li>
        
          <li>
            <a href="/docs/react.html#_">
              React
            </a>
            
          </li>
        
      </ul>
    </section>
  
</nav>


<article class='withtoc'>
    <h1>
      Checking third-party code
      <a class="edit-page-link" href="https://github.com/facebook/flow/tree/master/website/docs/02-third-party.md" target="_blank">Edit on GitHub</a>
    </h1>
    <p></p>

    <p>Most real JavaScript programs depend on third-party libraries. This guide shows how to use Flow in a project with external dependencies, without having to typecheck library code.</p>

<h2>Interface Files</h2>

<p>Flow supports <em>interface files</em> for the purpose of understanding third party code you did not write. These files define the interface to a library, including types, separately from the actual code of the library. You never need to change library code to use interface files, but your code will be typechecked against the types declared in the interface file.</p>

<p>The workflow for dealing with library code is:</p>

<ul>
<li>Do not change the library files or add <code>@flow</code> to them</li>
<li>Add one or more interface files for your libraries in a special directory in your project - for example <code>interfaces</code></li>
<li>Point Flow at those interface files by starting it with <code>flow start --lib  &lt;path to your interface files&gt;</code> or by specifying a <code>[libs]</code> section in your <code>.flowconfig</code> file as such:</li>
</ul>
<div class="highlight"><pre><code class="language-" data-lang="">[libs]
interfaces/
</code></pre></div>
<h2>Example</h2>

<p>To illustrate this workflow, we&#39;ll pick the <a href="http://underscorejs.org/">Underscore</a> library. Let&#39;s say we have this simple file using Underscore:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre><span class="cm">/* @flow */</span>

<span class="kd">var</span> <span class="nx">pizzas</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'Margherita'</span><span class="p">,</span> <span class="na">vegetarian</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'Pepperoni'</span><span class="p">,</span> <span class="na">vegetarian</span><span class="p">:</span> <span class="kc">false</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'Four cheese'</span><span class="p">,</span> <span class="na">vegetarian</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">title</span><span class="p">:</span> <span class="s1">'Hawaiian'</span><span class="p">,</span> <span class="na">vegetarian</span><span class="p">:</span> <span class="kc">false</span> <span class="p">},</span>
<span class="p">];</span>

<span class="kd">function</span> <span class="nx">vegetarianPizzas</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">findWhere</span><span class="p">(</span><span class="nx">pizzas</span><span class="p">,</span> <span class="p">{</span><span class="na">vegetarian</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Running <code>flow</code> will unsurprisingly produce an error:</p>
<div class="highlight"><pre><code class="language-bbcode" data-lang="bbcode">underscore_example.js:11:10,10: unknown global name: _
</code></pre></div>
<p>This is because Flow doesn&#39;t know anything about the <code>_</code> variable/module. To fix this we need to bring in an interface file for Underscore.:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="nx">declare</span> <span class="kr">class</span> <span class="nx">Underscore</span> <span class="p">{</span>
  <span class="nx">findWhere</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">list</span><span class="err">:</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">properties</span><span class="err">:</span> <span class="p">{})</span><span class="err">:</span> <span class="nx">T</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">declare</span> <span class="kd">var</span> <span class="nx">_</span><span class="err">:</span> <span class="nx">Underscore</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>This only describes (part of) the interface for Underscore, eliding all implementation details - so Flow never has to understand the Underscore code itself.</p>

<p>If we now add the <code>interfaces/</code> directory to our flow config under a <code>[libs]</code> section:</p>
<div class="highlight"><pre><code class="language-" data-lang="">[libs]
interfaces/
</code></pre></div>
<p>We can run flow again and see that the error goes away:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$&gt; </span>flow
</code></pre></div><div class="highlight"><pre><code class="language-" data-lang="">Found 0 errors
</code></pre></div>
<p>If you temporarily modify your code that uses Underscore to purposefully introduce a type error, you can verify that it&#39;s now being checked against this interface file.</p>

<p>When defining the interface for a library, you can use the <code>any</code> type whenever you don&#39;t need Flow to check a value. This lets you gradually add type definitions for the parts of the library you care most about. See the reference guide on <a href="declarations.html">declarations</a> for more details.</p>


    <div class="docs-prevnext">
      
        <a href="/docs/type-annotations.html#_">&larr; Prev</a>
      
      
        <a class="right" href="/docs/running.html#_">Next &rarr;</a>
      
    </div>

    <a id="_"></a>
</article>

</div></section>
<footer><div class='width'>
    &copy; Copyright 2014 - 2016, Facebook Inc.
</div></footer>

<script src="/static/linkify.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-49208336-4', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>

