

<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
<head>
    <meta charset='utf-8'>
    <title>Flow | Version 0.21.0</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />
    <link type="text/css" rel="stylesheet" href="/assets/flow.css">
    <link type="text/css" rel="stylesheet" href="/assets/syntax.css">
    <link rel='shortcut icon' href='/static/favicon.png'>
    <meta name='viewport' content='width=480'>
    <meta property="og:title" content="Version 0.21.0" />
    <meta property="og:site_name" content="flowtype">
    <meta property='og:description' content='Flow is a static type checker for
    JavaScript.'>
    <meta property='og:image' content='http://flowtype.org/static/flow-og-image.png'>
    <meta property='og:url' content="http://flowtype.org/blog/2016/02/02/Version-0.21.0.html">
    
    <meta property='og:type' content='article'>
    <meta property='article:author' content="https://www.facebook.com/Gabe">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script>
    <script type="text/javascript">{'try{Typekit.load();}catch(e){}'}</script>
    <link rel="alternate" type="application/rss+xml" title="Flow" href="http://flowtype.org/blog/feed.xml">
</head>
<body>

<header class='topbar'><nav class='width'>
<a href='/'>
  <img src="/static/flow-logo.png" class="logo">
</a>
    <ul>
      <li><a href="/docs/getting-started.html#_"
          >
          Docs
      </a></li>
      <li><a href="/docs/about-flow.html#_"
          >
          About
      </a></li>
      <li><a href="/support.html"
          >
          Support
      </a></li>
      <li><a href="/blog"
          
            class="active"
          >
          Blog
      </a></li>
      <li>
        <input id="algolia-doc-search" type="text" placeholder="Search docs..." />
      </li>
    </ul>
    <ul class="external">
      <li><a href="http://github.com/facebook/flow">GitHub</a>
    </ul>
</nav></header>


<section class='content'><div class='width'>

<nav class='toc'>
  <section>
    <h3>Recent Posts</h3>
    <ul>
      
      
        <li>
          <a 
             class="active" 
            href="/blog/2016/02/02/Version-0.21.0.html">
            Version 0.21.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/12/01/Version-0.19.0.html">
            Version 0.19.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/11/09/Generators.html">
            Generators
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/10/07/Version-0.17.0.html">
            Version 0.17.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/09/22/Version-0.16.0.html">
            Version 0.16.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/09/10/Version-0.15.0.html">
            Version 0.15.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/07/29/Version-0.14.0.html">
            Version 0.14.0
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/07/03/Disjoint-Unions.html">
            Disjoint Unions
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/03/12/Bounded-Polymorphism.html">
            Bounded Polymorphism
          </a>
        </li>
      
      
        <li>
          <a 
            
            href="/blog/2015/02/20/Flow-Comments.html">
            Flow Comments
          </a>
        </li>
      
      <li><a 
        
        href="/blog/all.html">All posts ...</a></li>
    </ul>
  <section>
</nav>


<article class='withtoc'>
    <div class="edit-page-block">
      <h1>
        Version 0.21.0
      </h1>
      <a class="edit-page-link" href="https://github.com/facebook/flow/tree/master/website/_posts/2016-02-02-Version-0.21.0.md" target="_blank">Edit on GitHub</a>
    </div>
    <p class="meta">February  2, 2016 by Gabe Levi</p>

    <h3>Flow v0.21.0</h3>

<p>Yesterday we deployed Flow v0.21.0! As always, we&#39;ve listed out the most interesting changes in the <a href="https://github.com/facebook/flow/blob/master/Changelog.md#v0210">Changelog</a>. However, since I&#39;m on a plane and can&#39;t sleep, I thought it might be fun to dive into a couple of the changes! Hope this blog post turns out interesting and legible!</p>

<h4>JSX Intrinsics</h4>

<p>If you&#39;re writing JSX, it&#39;s probably a mix of your own React Components and some intrinsics. For example, you might write</p>
<div class="highlight"><pre><code class="language-JavaScript" data-lang="JavaScript">render() {
  return &lt;div&gt;&lt;FluffyBunny name="Fifi" /&gt;&lt;/div&gt;;
}
</code></pre></div>
<p>In this example, <code>FluffyBunny</code> is a React Component you wrote and <code>div</code> is a JSX intrinsic. Lower-cased JSX elements are assumed to be intrinsics by React and by Flow. Up until Flow v0.21.0, Flow ignored intrinsics and gave them the type <code>any</code>. This meant Flow let you set any property on JSX intrinsics. Flow v0.21.0 will, by default, do the same thing as v0.20.0, However now you can also configure Flow to properly type your JSX intrinsics!</p>

<!--truncate-->

<h5>Example of how to use JSX intrinsics</h5>

<p>.flowconfig</p>
<div class="highlight"><pre><code class="language-JavaScript" data-lang="JavaScript">[libs]
myLib.js
</code></pre></div>
<p>myLib.js</p>
<div class="highlight"><pre><code class="language-JavaScript" data-lang="JavaScript">// JSXHelper is a type alias to make this example more concise.
// There's nothing special or magic here.
// JSXHelper&lt;{name: string}&gt; is a React component
// with the single string property "name", which has a default
type JSXHelper&lt;T&gt; = Class&lt;ReactComponent&lt;T,T,mixed&gt;&gt;;

// $JSXIntrinsics is special and magic.
// This declares the types for `div` and `span`
type $JSXIntrinsics = {
  div: JSXHelper&lt;{id: string}&gt;,
  span: JSXHelper&lt;{id: string, class: string}&gt;,
};
</code></pre></div>
<p>myCode.js</p>
<div class="highlight"><pre><code class="language-JavaScript" data-lang="JavaScript">&lt;div id="asdf" /&gt;; // No error
&lt;div id={42} /&gt;; // Error: `id` prop is a string, not a number!
</code></pre></div>
<h5>What is going on here?</h5>

<p>The new bit of magic is this <code>$JSXIntrinsics</code> type alias. When Flow sees <code>&lt;foo /&gt;</code> it will look to see if <code>$JSXIntrinsics</code> exists and if so will grab the type of <code>$JSXIntrinsics[&#39;foo&#39;]</code>. It will use this type to figure out which properties are available and need to be set.</p>

<p>We haven&#39;t hardcoded the intrinsics into Flow since the available intrinsics will depend on your environment. For example, React native would have different intrinsics than React for the web would.</p>

<h4>Smarter string refinements</h4>

<p>One of the main ways that we make Flow smarter is by teaching it to recognize more ways that JavaScript programmers refine types. Here&#39;s an example of a common way to refine nullable values:</p>
<div class="highlight"><pre><code class="language-JavaScript" data-lang="JavaScript">class Person {
  name: ?string;
  ...
  getName(): string {
    // Before the if, this.name could be null, undefined, or a string
    if (this.name != null) {
      // But now the programmer has refined this.name to definitely be a string
      return this.name;
    }
    // And now we know that this.name is null or undefined.
    return 'You know who';
  }
}
</code></pre></div>
<h5>New string refinements</h5>

<p>In v0.21.0, one of the refinements we added is the ability to refine types by comparing them to strings.</p>

<p>This is useful for refining unions of string literals into string literals</p>
<div class="highlight"><pre><code class="language-" data-lang="">function test(x: 'foo' | 'bar'): 'foo' {
  if (x === 'foo') {
    // Now Flow understands that x has the type 'foo'
    return x;
  } else {
    return 'foo';
  }
}
</code></pre></div>
<p>And can also narrow the value of strings:</p>
<div class="highlight"><pre><code class="language-" data-lang="">function test(x: string): 'foo' {
  if (x === 'foo') {
    // Now Flow knows x has the type 'foo'
    return x;
  } else {
    return 'foo';
  }
}
</code></pre></div>
<p>This is one of the many refinements that Flow currently can recognize and follow, and we&#39;ll keep adding more! Stay tuned!</p>


    <a 
  href="https://twitter.com/share" 
  class="twitter-share-button" 
  data-url="http://flowtype.org/blog/2016/02/02/Version-0.21.0.html" 
  data-text="Flow | Version 0.21.0" 
  data-hashtags="flowtype">Tweet</a>
<div 
  class="fb-like" 
  data-href="http://flowtype.org/blog/2016/02/02/Version-0.21.0.html" 
  data-layout="standard" 
  data-action="like"
  data-show-faces="true"
  data-share="true"></div>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

</article>

</div></section>
<footer><div class='width'>
    &copy; Copyright 2014 - 2016, Facebook Inc.
</div></footer>

<script type="text/javascript" src="/assets/default.js"></script>
<script>
  docsearch({
    apiKey: 'cf314b2976b27157c82b6f27553497f5',
    indexName: 'flowtype',
    inputSelector: '#algolia-doc-search'
  });
</script>
</body>
</html>

